---
title: "ER 模型中的那些关系"
date: 2022-11-22T08:58:00+08:00
lastmod: 2022-12-01T19:13:00+08:00
author: ["xiaoji"]
keywords: 
- 
categories: 
- 小册子
tags:
- ERD
- ERM
- ER图
description: ""
weight:
slug: ""
draft: flase # 是否为草稿
comments: true # 允许评论
reward: true # 允许打赏
mermaid: true #是否开启mermaid
showToc: true # 显示目录
TocOpen: true # 自动展开目录
disableShare: true  # 底部不显示分享栏
showbreadcrumbs: true #顶部显示路径
cover:
    image: "" #图片路径例如：posts/tech/123/123.png
    caption: "" #图片底部描述
    alt: ""
    relative: false
---

上一节我们了解了实体关系模型的概况，连接在这里👇
<br>
<br>
[ER 模型入门教程](https://www.bmms.me/posts/booklet/getting-started-with-entity-relationship-model/)

接下来我们再深入了解下实体关系模型中的「关系」的细节。

我们都知道，现实世界中，关系其实是很复杂的，不仅有数量上的对应，还会有条件上的限制，在一段实体关系中，某些情况下，可能是两者都必须参与，也可以是其中某一方不需要参与。比如我们说婚姻关系需要夫妻双方都必须参与，而婚姻与生子方面，就是可选关系。一段婚姻可能会出现 0 或 n  个小孩。

在实体之间，出现了这种可选条件的限制，就会让原本的实体关系模型更加复杂。但同时，引入了这种条件的限制，它能够覆盖到的场景也更多。比如现实世界可能存在以下几种情况
为了方便表达这种条件关系，我们引入新的符号。我们用实心圆(

这样描述可能还是比较抽象，下面我们从一个具体的案例着手看看。

马上要过年了，我们就以过年买票为例子。买票可能需要通过一个平台去帮我们生成订单，比如通过同程旅行网，我们把这样的代订票网站称作预定平台。那么根据上面说到的条件限制关系，可能就存在以下这些情况。

## 一对一关系的可选与必选条件
「用户」必须都通过一个「预定平台」去「购票」，而且每个「预定平台」都只能给指定的「用户」去订票。当然这种情况在现实中不可能，但为了方便理解，我们假设存在这种极端的情况。
![一对一关系两端都必选示意图](%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E7%B3%BB%E4%B8%A4%E7%AB%AF%E9%83%BD%E5%BF%85%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

「用户」要想买票必须要通过某个「预定平台」才能「购票」。但每个「预定平台」可以不为某个人订票，换句话说，「预定平台」可以不需要买票人就订票。同样的，在现实生活中，由于实名制的规范化，这种情况也是不存在的。
![一对一关系，一端必选，另一端可选示意图](%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%80%E7%AB%AF%E5%BF%85%E9%80%89%EF%BC%8C%E5%8F%A6%E4%B8%80%E7%AB%AF%E5%8F%AF%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

我们要「购票」可以选择通过某个「预定平台」，当然也可以去 12306 直接购买，又或者去线下车站购买。但「预定平台」要想产生购票订单，则必须要有指定的购票人才能进行。这种场景就跟我们真实世界就比较像了。
![一对一关系，一端可选，另一端强制示意图](%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%80%E7%AB%AF%E5%8F%AF%E9%80%89%EF%BC%8C%E5%8F%A6%E4%B8%80%E7%AB%AF%E5%BC%BA%E5%88%B6%E7%A4%BA%E6%84%8F%E5%9B%BE.png)


我们可以选择去自己专属的「预定平台」去购票，也可以选择去线下或 12306 购票。同样「预定平台」也可以做其他相关业务，但只要他进行票务预定，则必须要有某个人提供购票信息。并且这个「预定平台」只服务于这个人。
![一对一关系，两端都可选示意图](%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%A4%E7%AB%AF%E9%83%BD%E5%8F%AF%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)


## 一对多关系的可选与必选条件
两个实体都是强制性的，每个「订票」必须有一个或者多个「用户」参与，同样，每个「用户」必须产生一笔或多笔「订票」单。
![一对多关系，两端都必选示意图](%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%A4%E7%AB%AF%E9%83%BD%E5%BF%85%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

「用户」产生一笔或多笔「订票」单，但预订可能不涉及某个「用户」，比如预订可能是下火车票订单，也可能是替某个团体或企业「订票」，此时预定则不需要涉及用户。
![一对多关系，一端必选另一端可选示意图](%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%80%E7%AB%AF%E5%BF%85%E9%80%89%E5%8F%A6%E4%B8%80%E7%AB%AF%E5%8F%AF%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)


用户可能选择下「订票」订单，这不是必须的，但每个「订票」行为，必须涉及一个或多个用户。这个和我们现实生活中的场景一致，你可以注册同程网的会员，但不买票，而一旦你需要「订票」，则至少要有一个乘客人信息。
![一对多关系，一端可选另一端必选示意图](%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%80%E7%AB%AF%E5%8F%AF%E9%80%89%E5%8F%A6%E4%B8%80%E7%AB%AF%E5%BF%85%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)


在这种情况下，「订票」可以不涉及某个特定的「用户」，而「用户」也可以选择是否需要「订票」，此时两端都非常灵活。
![一对多关系，两端都可选示意图](%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%A4%E7%AB%AF%E9%83%BD%E5%8F%AF%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)


## 多对多关系的可选和必选条件
用户必须通过一个或多个「预定平台」才能够买到票，也就说不存在线下或者自己去「12306」买票的情况，而「预定平台」要想买票，则必须要有一个或者多个「用户」下了单。
![多对多关系，两端必选示意图](%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%A4%E7%AB%AF%E5%BF%85%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

「用户」还是必须通过一个或多个「预定平台」采购购票，但「预定平台」则很灵活，它能够在不涉及「用户」的情况下，提前先屯票。
![多对多关系，一端必选另一端可选示意图](%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%80%E7%AB%AF%E5%BF%85%E9%80%89%E5%8F%A6%E4%B8%80%E7%AB%AF%E5%8F%AF%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)


「用户」可以自己选择去一个或者多个「预定平台」进行购票，但这不是必须的，「用户」也可以找自己的渠道买票。而「预定平台」需要购票，则必须要由一个或者多个用户下单了才行。这和我们的真实世界完全吻合了。
![多对多关系，一端可选另一端必选示意图](%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%80%E7%AB%AF%E5%8F%AF%E9%80%89%E5%8F%A6%E4%B8%80%E7%AB%AF%E5%BF%85%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)


这种情况，两者都非常灵活，用户可以自行选择多种渠道购票，「预定平台」则可以在不涉及特定用户的情况下，提前先买票，当然也支持有「用户」订单的情况下购票。
![多对多关系，两端都可选示意图](%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%B8%A4%E7%AB%AF%E9%83%BD%E5%8F%AF%E9%80%89%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

## 参考资料
[Chapter 6. Entity-Relationship Modelling](https://www.cs.uct.ac.za/mit_notes/database/htmls/chp06.html#objectives)

